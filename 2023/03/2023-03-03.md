---
tags: vbs, wscript, 再学習
title: 繰り返し実行するvbsを書く
---
# 2023-03-03.md

## 繰り返し実行するvbsを書く

#### Q:現在時刻を取得して変数startTimeに代入して、startTimeに対して５分経過したらメッセージを表示したい。それをwscriptで書くと？

#### A:現在時刻を取得して変数startTimeに代入して、startTimeに対して5分経過したらメッセージを表示するスクリプトをwscriptで書くと、以下のようになります。

```vbs=
Dim startTime
Dim currentTime
Dim elapsedTime

' 現在時刻を取得してstartTimeに代入
startTime = new Date()

' 無限ループを開始
Do While True

  ' 現在時刻を取得してcurrentTimeに代入
  currentTime = new Date()

  ' startTimeとcurrentTimeの差分（ミリ秒）をelapsedTimeに代入
  elapsedTime = currentTime - startTime

  ' elapsedTimeが300000（5分）以上ならメッセージを表示し、ループを抜ける
  If elapsedTime >= 300000 Then
    MsgBox "5 minutes have passed."
    Exit Do
  End If

Loop
```

このスクリプトは、5分経過するまで他の処理を行うことができません。もし他の処理を行いたい場合は、Windowsタスクスケジューラーなどの外部ツールを利用する必要があります。

以上でよろしいですか？

