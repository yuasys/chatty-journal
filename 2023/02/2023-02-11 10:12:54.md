# 2023-02-11 10:12:54.md

## はじめてPower Automateを使ってみた

![](https://i.imgur.com/xgLVojj.png)

まずは、自分の足元の作業から改善をしようと思いました。１０００の資料を漁るよりも、一つの省力化・自動化改善を実践した方がよほど価値があると考えたからです。  

ここ数週間は、長期間遠ざかっていたWindowsがとても気に入り、いまではもう主力機になりつつあります。  
懐かしさもあり、この数日前から、VBSとWindows11標準搭載のPower Automateを組み合わせた自動化の技法に親しんでおきたいと強く思うことになったのです。  

この日誌の新規ページを毎日追加するという単純な作業を簡単なコーディング（ローコード）で自動化してしまいました。  
まだまだ不慣れで、不満は残りますが、ちょっとして定型作業が全自動でできることは精神的に、とても楽しいです。

### Power Automate Desktopを最強にする２つの助っ人

有料版でしかできないタイムスケジュールによる起動も、２つの助っ人を組み合わせるとバッチリ実現できるので、とても心強いです。

助っ人とは**VBS**と**タスクマネージャー**です。

#### 処理の概要設計

1. トリガーにするファイルは一日一回VBSをタスクスケジューラで起動して作ってあげる
2. Automaiteは常時ファイルの存在をチェックして有ればページ追加処理をする


![](https://i.imgur.com/aLe6Lfs.png)

#### **タスクマネージャで一日一回このスクリプトを実行する**

trigger.vbs 

```vbs=
dim fs
dim fn

'ファイル作成
Set fs = WScript.CreateObject("Scripting.FileSystemObject")
Set fn = Fs.CreateTextFile("C:\Users\yuasy\source\vbs\trigger.txt")

'後処理
fn.close
Set fs = Nothing
```

#### automateのアクション設定

![](https://i.imgur.com/JvhAr8S.png)

